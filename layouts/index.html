{{- define "content" -}}
  {{- $params := .Scratch.Get "params" -}}
  {{- $profile := .Site.Params.home.profile -}}
  {{- $posts := .Site.Params.home.posts -}}

  <div class="page home"{{ if ne $posts.enable false }} data-home="posts"{{ end }}>
    {{- /* Profile */ -}}
    {{- if ne $profile.enable false -}}
      {{- partial "home/profile.html" . -}}
    {{- end -}}

    {{- /* Content */ -}}
    {{- if .Content -}}
      <div class="single">
        <div class="content" id="content">
          {{- dict "Content" .Content "Ruby" $params.ruby "Fraction" $params.fraction "Fontawesome" $params.fontawesome | partial "function/content.html" | safeHTML -}}
        </div>
      </div>
    {{- end -}}

    {{- /* Posts */ -}}
    {{ $series_intro := slice "series intro" }}
    {{ $series_intro_posts := where .Site.Pages ".Params.tags" "intersect" $series_intro }}


    <h1>My Top 5 Favorite Series</h1>

    <hr>

    {{ range first 5 $series_intro_posts }}
      {{- if ne $posts.enable false | and .Site.RegularPages -}}
        {{- /* Paginate */ -}}
        {{- $pages := where .Site.RegularPages "Type" "posts" -}}
        {{- if .Site.Params.page.hiddenFromHomePage -}}
          {{- $pages = where $pages "Params.hiddenfromhomepage" false -}}
        {{- else -}}
          {{- $pages = where $pages "Params.hiddenfromhomepage" "!=" true -}}
        {{- end -}}
        {{- with $posts.paginate | default .Site.Params.paginate -}}
          {{- $pages = $.Paginate $pages . -}}
        {{- else -}}
          {{- $pages = .Paginate $pages -}}
        {{- end -}}
        {{- .Render "summary" -}}
      {{- end -}}
    {{ end }}

    View the rest <strong><a href="/tags/series-intro">here</a></strong>.

    <h1>My Top 5 Favorite Posts</h1>

    <hr>

    {{ $favorite := slice "favorite" }}
    {{ $favorite_posts := where .Site.Pages ".Params.tags" "intersect" $favorite }}
    {{ $favorite_display_posts := $favorite_posts }}

    {{ range first 5 $favorite_display_posts }}
      {{- if ne $posts.enable false | and .Site.RegularPages -}}
        {{- /* Paginate */ -}}
        {{- $pages := where .Site.RegularPages "Type" "posts" -}}
        {{- if .Site.Params.page.hiddenFromHomePage -}}
          {{- $pages = where $pages "Params.hiddenfromhomepage" false -}}
        {{- else -}}
          {{- $pages = where $pages "Params.hiddenfromhomepage" "!=" true -}}
        {{- end -}}
        {{- with $posts.paginate | default .Site.Params.paginate -}}
          {{- $pages = $.Paginate $pages . -}}
        {{- else -}}
          {{- $pages = .Paginate $pages -}}
        {{- end -}}
        {{- .Render "summary" -}}
      {{- end -}}
    {{ end }}

    View the rest <strong><a href="/tags/favorites">here</a></strong>.

  </div>
{{- end -}}
